# -*- coding: utf-8 -*-
"""app
Automatically generated by Colab.
Original file is located at
    https://colab.research.google.com/drive/113L1QzGyfkDEx2eGmbAKDf6FVRvgPTz6
"""

import streamlit as st
import pandas as pd
import numpy as np
from sklearn.ensemble import IsolationForest
import matplotlib.pyplot as plt
import seaborn as sns
import random
import datetime
import base64

sns.set_style("whitegrid")
st.set_page_config(page_title="WaterGuard", layout="wide")

# ---------- LANGUAGE TOGGLE ---------- #
language = st.sidebar.radio("🌐 Language / اللغة", ["English", "العربية"])
lang = "ar" if language == "العربية" else "en"

# ---------- BACKGROUND IMAGE ---------- #
def set_background(image_path):
    with open(image_path, "rb") as img_file:
        encoded = base64.b64encode(img_file.read()).decode()
    st.markdown(
        f"""
        <style>
        .stApp {{
            background-image: url("data:image/jpg;base64,{encoded}");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            position: relative;
            color: #f0f0f0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }}
        .stApp::before {{
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.45);
            z-index: -1;
        }}
        [data-testid="stSidebar"] {{
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0 15px 15px 0;
            padding: 1rem 1.5rem;
            box-shadow: 2px 0 12px rgba(0, 0, 0, 0.1);
        }}
        </style>
        """,
        unsafe_allow_html=True,
    )

set_background("water_bg.jpg")

# ---------- INTRO SECTION ---------- #
if lang == "en":
    st.markdown("""
        <div style="background: rgba(255, 255, 255, 0.9); padding: 2rem; border-radius: 15px; max-width: 900px; margin: 3rem auto; color: #111; box-shadow: 0 8px 20px rgba(0,0,0,0.15); font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
            <h1 style="color: #023e8a; font-weight: 700;">💧 WaterGuard Prototype</h1>
            <p style="font-size: 1.1rem; line-height: 1.5;">
                This prototype simulates a smart water metering system for households, businesses, and factories in Muharaq using AI to track anomalies and save costs.
            </p>
            <h3 style="color: #023e8a; font-weight: 700;">Targeted Features:</h3>
            <ul style="font-size: 1rem; line-height: 1.6;">
                <li><strong>For Homes:</strong> Help families save money by detecting leaks early and reducing unnecessary water use.</li>
                <li><strong>For Businesses:</strong> Monitor water efficiency across multiple units to reduce utility costs.</li>
                <li><strong>For Factories:</strong> Track industrial water processes and receive alerts on costly water loss or misuse.</li>
            </ul>
        </div>
    """, unsafe_allow_html=True)
else:
    st.markdown("""
        <div style="background: rgba(255, 255, 255, 0.9); padding: 2rem; border-radius: 15px; max-width: 900px; margin: 3rem auto; color: #111; box-shadow: 0 8px 20px rgba(0,0,0,0.15); font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; direction: rtl; text-align: right;">
            <h1 style="color: #023e8a; font-weight: 700;">💧 نموذج ووتر جارد</h1>
            <p style="font-size: 1.1rem; line-height: 1.5;">
                يحاكي هذا النموذج الذكي نظام قياس المياه للمنازل والشركات والمصانع في المحرق باستخدام الذكاء الاصطناعي للكشف عن التسريبات وتوفير التكاليف.
            </p>
            <h3 style="color: #023e8a; font-weight: 700;">المزايا المستهدفة:</h3>
            <ul style="font-size: 1rem; line-height: 1.6;">
                <li><strong>للمنازل:</strong> يساعد الأسر على توفير المال من خلال اكتشاف التسريبات وتقليل استخدام المياه الزائد.</li>
                <li><strong>للشركات:</strong> مراقبة كفاءة استخدام المياه وتقليل فواتير المرافق.</li>
                <li><strong>للمصانع:</strong> تتبع استهلاك المياه الصناعي والحصول على تنبيهات حول أي خسائر مفرطة في المياه.</li>
            </ul>
        </div>
    """, unsafe_allow_html=True)

